{"version":3,"sources":["webpack:///./src/views/login/index.vue?9596","webpack:///./src/views/login/index.vue?bd00","webpack:///src/views/login/index.vue","webpack:///./src/views/login/index.vue?e0c5","webpack:///./src/views/login/index.vue","webpack:///./src/api/user.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","ref","model","value","login","callback","$$v","$set","expression","slot","showcountDown","_e","on","sendMessage","_v","$event","staticClass","userLogin","staticRenderFns","data","mobile","code","methods","component","request","url","method","getmsCode","getUserInfo","getUserById","userId","addFollow","target","deleteFollow","getUserProfile","updateUserPhoto","updateUserProfile"],"mappings":"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","file":"js/chunk-29445917.30bd374d.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=33ad7fe8&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=33ad7fe8&lang=less&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('van-nav-bar',{attrs:{\"title\":\"登录\"}}),_c('ValidationObserver',{ref:\"myForm\"},[_c('ValidationProvider',{attrs:{\"name\":\"手机号\",\"rules\":\"required|mobile\",\"immediate\":\"\"}},[_c('van-field',{attrs:{\"clearable\":\"\",\"label\":\"手机号\",\"placeholder\":\"请输入手机号\"},model:{value:(_vm.login.mobile),callback:function ($$v) {_vm.$set(_vm.login, \"mobile\", $$v)},expression:\"login.mobile\"}},[_c('van-icon',{attrs:{\"slot\":\"left-icon\",\"class-prefix\":\"icon\",\"name\":\"shouji\"},slot:\"left-icon\"})],1)],1),_c('ValidationProvider',{attrs:{\"name\":\"验证码\",\"rules\":\"required|code\",\"immediate\":\"\"}},[_c('van-field',{attrs:{\"label\":\"验证码\",\"placeholder\":\"请输入验证码\"},model:{value:(_vm.login.code),callback:function ($$v) {_vm.$set(_vm.login, \"code\", $$v)},expression:\"login.code\"}},[(!this.showcountDown)?_c('van-button',{attrs:{\"slot\":\"button\",\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":_vm.sendMessage},slot:\"button\"},[_vm._v(\"发送验证码\")]):_vm._e(),_c('van-icon',{attrs:{\"slot\":\"left-icon\",\"class-prefix\":\"icon\",\"name\":\"suo\"},slot:\"left-icon\"}),(this.showcountDown)?_c('van-count-down',{attrs:{\"slot\":\"button\",\"time\":60 * 1000,\"format\":\"ss s\"},on:{\"finish\":function($event){_vm.showcountDown=false}},slot:\"button\"}):_vm._e()],1)],1)],1),_c('div',{staticClass:\"sub_button\"},[_c('van-button',{staticClass:\"mes_btn\",attrs:{\"type\":\"info\"},on:{\"click\":_vm.userLogin}},[_vm._v(\"登录\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <van-nav-bar title=\"登录\"></van-nav-bar>\n    <!--\n      表单验证\n      1、使用 ValidationObserver 组件把需要验证的整个表单包起来\n      2、使用 ValidationProvider 组件把具体的表单元素包起来，例如 input\n         name   配置字段的提示名称\n         rules  配置校验规则\n         v-slot=\"{ errors }\" 获取校验失败的错误提示消息\n    -->\n    <ValidationObserver ref=\"myForm\">\n      <ValidationProvider name='手机号' rules=\"required|mobile\" immediate>\n        <van-field v-model=\"login.mobile\" clearable label=\"手机号\" placeholder=\"请输入手机号\">\n          <van-icon class-prefix=\"icon\" name=\"shouji\" slot=\"left-icon\" />\n        </van-field>\n      </ValidationProvider>\n      <ValidationProvider name='验证码' rules=\"required|code\" immediate>\n        <van-field v-model=\"login.code\"  label=\"验证码\" placeholder=\"请输入验证码\">\n          <van-button\n            slot=\"button\"\n            size=\"small\"\n            type=\"primary\"\n            @click=\"sendMessage\"\n            v-if=\"!this.showcountDown\"\n          >发送验证码</van-button>\n          <!-- 引图标 -->\n          <van-icon class-prefix=\"icon\" name=\"suo\" slot=\"left-icon\" />\n          <!-- 引倒计时组件 -->\n          <van-count-down\n            :time=\"60 * 1000\"\n            format=\"ss s\"\n            slot=\"button\"\n            v-if=\"this.showcountDown\"\n            @finish=\"showcountDown=false\"\n          />\n        </van-field>\n        </ValidationProvider>\n    </ValidationObserver>\n    <div class=\"sub_button\">\n      <van-button type=\"info\" class=\"mes_btn\" @click=\"userLogin\">登录</van-button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { login, getmsCode } from '@/api/user.js'\nimport { validate } from 'vee-validate'\nexport default {\n  data () {\n    return {\n      login: {\n        mobile: '',\n        code: ''\n      },\n      showcountDown: false\n    }\n  },\n  methods: {\n    // 登录\n    async userLogin () {\n      // 表单验证\n      let success = await this.$refs.myForm.validate()\n      if (!success) {\n        // 手动表单验证失败\n        // 获取失败的错误提示  通过ref获取表单  表单的error属性中含有信息\n        // 直接获取 表没有错误信息 必须给每一个 ValidationProvider 配置 immediate 初始验证\n        let err = this.$refs.myForm.errors\n        console.log('失败', err)\n        for (let key in err) {\n          let item = err[key]\n          if (item[0]) {\n            // debugger\n            console.log(item[0])\n            this.$toast(item[0])\n            return\n          }\n        }\n      }\n      // 验证成功\n      // 开启登录loading\n      this.$toast.loading({\n        duration: 0, // 持续展示toast\n        message: '登陆中...',\n        forbidClick: true // 是否禁止背景点击\n      })\n      try {\n        let res = await login(this.login)\n        // 成功加载成功toast\n        // console.log(res.data)\n        this.$store.commit('setToken', res.data.data)\n        this.$toast.success('登录成功')\n        const redirect = this.$route.query.redirect || '/'\n        this.$router.push(redirect)\n      } catch (error) {\n        this.$toast.fail('手机号或验证码不正确')\n      }\n    },\n    // 发送验证码\n    async sendMessage () {\n      // 验证指定数据字段\n      try {\n        // 获取手机号\n        let { mobile } = this.login\n        // 发送验证码之前进行验证 验证手机号是否有效\n        let result = await validate(mobile, 'required|mobile', {\n          name: '手机号'\n        })\n        // console.log(result)\n\n        if (!result.valid) {\n          this.$toast(result.errors[0])\n          return\n        }\n        // 显示倒计时\n        this.showcountDown = !this.showcountDown\n        await getmsCode(mobile)\n      } catch (error) {\n        this.showcountDown = false\n        this.$toast('请勿频繁操作')\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.sub_button {\n  padding: 27px 16px;\n  .mes_btn {\n    width: 100%;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=33ad7fe8&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=33ad7fe8&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"33ad7fe8\",\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/request.js'\n\nexport const login = data => {\n  return request({\n    url: '/app/v1_0/authorizations',\n    method: 'post',\n    data\n  })\n}\n// 发送验证码\n\nexport const getmsCode = data => {\n  return request({\n    method: 'GET',\n    url: `/app/v1_0/sms/codes/${data}` // 参数为电话号\n  })\n}\n// 获取当前登录用户信息\nexport const getUserInfo = () => {\n  return request({\n    method: 'GET',\n    url: '/app/v1_0/user'\n  })\n}\n// 获取指定用户信息\nexport const getUserById = userId => {\n  return request({\n    method: 'GET',\n    url: `/app/v1_0/users/${userId}`\n  })\n}\n// 关注\nexport const addFollow = userId => {\n  return request({\n    method: 'POST',\n    url: '/app/v1_0/user/followings',\n    data: {\n      target: userId\n    }\n  })\n}\n// 取消关注\nexport const deleteFollow = userId => {\n  return request({\n    method: 'DELETE',\n    url: `/app/v1_0/user/followings/${userId}`\n  })\n}\n// 获取用户资料\nexport const getUserProfile = () => {\n  return request({\n    method: 'GET',\n    url: '/app/v1_0/user/profile'\n  })\n}\nexport const updateUserPhoto = data => {\n  return request({\n    method: 'PATCH',\n    url: '/app/v1_0/user/photo',\n    data\n  })\n}\nexport const updateUserProfile = data => {\n  return request({\n    method: 'PATCH',\n    url: '/app/v1_0/user/profile',\n    data\n  })\n}\n"],"sourceRoot":""}